<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>SQL Storage Adapter - v0.2.0</title><meta name="description" content="Documentation for SQL Storage Adapter"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"><a href="https://frame.dev">Frame.dev</a><a href="https://github.com/framersai/sql-storage-adapter">GitHub</a><a href="https://www.npmjs.com/package/@framers/sql-storage-adapter">NPM</a></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">SQL Storage Adapter - v0.2.0</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>SQL Storage Adapter - v0.2.0</h1></div><div class="tsd-panel tsd-typography"><a id="md:sql-storage-adapter" class="tsd-anchor"></a><h1 class="tsd-anchor-link">SQL Storage Adapter<a href="#md:sql-storage-adapter" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p align="center">
  <a href="https://frame.dev" target="_blank" rel="noopener">
    <picture>
      <source media="(prefers-color-scheme: dark)" srcset="./logos/frame-square-blue-dark-no-tagline.svg">
      <source media="(prefers-color-scheme: light)" srcset="./logos/frame-square-blue-no-tagline.svg">
      <img src="media/frame-square-blue-no-tagline.svg" alt="Frame.dev" width="200">
    </picture>
  </a>
</p>
<p><a href="https://www.npmjs.com/package/@framers/sql-storage-adapter" target="_blank" class="external"><img src="https://img.shields.io/npm/v/@framers/sql-storage-adapter.svg?logo=npm&amp;label=npm" alt="npm version"></a>
<a href="https://github.com/framersai/sql-storage-adapter/actions/workflows/ci.yml" target="_blank" class="external"><img src="https://github.com/framersai/sql-storage-adapter/actions/workflows/ci.yml/badge.svg?branch=master" alt="CI"></a>
<a href="https://codecov.io/gh/framersai/sql-storage-adapter" target="_blank" class="external"><img src="https://codecov.io/gh/framersai/sql-storage-adapter/branch/master/graph/badge.svg" alt="codecov"></a>
<a href="https://www.typescriptlang.org/" target="_blank" class="external"><img src="https://img.shields.io/badge/TypeScript-5.6-blue.svg" alt="TypeScript"></a>
<a href="./LICENSE"><img src="https://img.shields.io/npm/l/@framers/sql-storage-adapter.svg" alt="License"></a></p>
<blockquote>
<p>Cross-platform SQL access for Node.js, web, and native runtimes with automatic adapter selection and consistent APIs.</p>
</blockquote>
<p>The SQL Storage Adapter provides a single, ergonomic interface over SQLite (native and WASM), PostgreSQL, Capacitor, and in-memory stores. It handles adapter discovery, capability detection, and advanced features like cloud backups so you can focus on your application logic.</p>
<hr>
<ul>
<li><a href="#md:features">Features</a></li>
<li><a href="#md:installation">Installation</a></li>
<li><a href="#md:quick-start">Quick Start</a></li>
<li><a href="#md:adapter-matrix">Adapter Matrix</a></li>
<li><a href="#md:configuration--resolution">Configuration &amp; Resolution</a></li>
<li><a href="#md:ci-releases-and-badges">CI, Releases, and Badges</a></li>
<li><a href="#md:troubleshooting">Troubleshooting</a></li>
<li><a href="#md:contributing">Contributing</a></li>
<li><a href="#md:license">License</a></li>
</ul>
<a id="md:features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Features<a href="#md:features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Auto-detected adapters</strong> – <code>createDatabase()</code> inspects environment signals and picks the best backend (native SQLite, PostgreSQL, Capacitor, sql.js, memory, etc.).</li>
<li><strong>Capability-aware API</strong> – consistent CRUD, transactions, batching, and event hooks across adapters with runtime capability introspection.</li>
<li><strong>Cloud backups &amp; migrations</strong> – built-in backup manager with compression, retention policies, and restore helpers plus migration utilities.</li>
<li><strong>Portable packaging</strong> – optional native dependencies; falls back to pure TypeScript/WASM adapters when native modules are unavailable.</li>
<li><strong>CI-first design</strong> – Vitest coverage, Codecov integration, and GitHub Actions workflows for linting, testing, releasing, and npm publish/tag automation.</li>
</ul>
<a id="md:installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#md:installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0"># Core package</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-3">install</span><span class="hl-2"> </span><span class="hl-3">@framers/sql-storage-adapter</span><br/><br/><span class="hl-0"># Install only the adapters you plan to use</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-3">install</span><span class="hl-2"> </span><span class="hl-3">better-sqlite3</span><span class="hl-2">            </span><span class="hl-0"># Native SQLite for Node/Electron</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-3">install</span><span class="hl-2"> </span><span class="hl-3">pg</span><span class="hl-2">                        </span><span class="hl-0"># PostgreSQL</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-3">install</span><span class="hl-2"> </span><span class="hl-3">@capacitor-community/sqlite</span><span class="hl-2">  </span><span class="hl-0"># Capacitor / mobile</span><br/><span class="hl-0"># sql.js ships with the package (no extra install)</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p>Windows users: ensure the Visual Studio Build Tools (C++ workload) are installed before adding <code>better-sqlite3</code>. On Linux, install <code>python3</code>, <code>build-essential</code>, and <code>libssl-dev</code> prior to <code>npm install</code>.</p>
</blockquote>
<a id="md:quick-start" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Quick Start<a href="#md:quick-start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-4">import</span><span class="hl-2"> { </span><span class="hl-5">createDatabase</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@framers/sql-storage-adapter&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-6">function</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2">() {</span><br/><span class="hl-2">  </span><span class="hl-0">// Automatically selects the best adapter for the current runtime</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-7">db</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-1">createDatabase</span><span class="hl-2">();</span><br/><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">db</span><span class="hl-2">.</span><span class="hl-1">exec</span><span class="hl-2">(</span><span class="hl-3">`</span><br/><span class="hl-3">    CREATE TABLE IF NOT EXISTS todos (</span><br/><span class="hl-3">      id INTEGER PRIMARY KEY,</span><br/><span class="hl-3">      task TEXT NOT NULL,</span><br/><span class="hl-3">      done INTEGER DEFAULT 0</span><br/><span class="hl-3">    )</span><br/><span class="hl-3">  `</span><span class="hl-2">);</span><br/><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">db</span><span class="hl-2">.</span><span class="hl-1">run</span><span class="hl-2">(</span><span class="hl-3">&#39;INSERT INTO todos (task) VALUES (?)&#39;</span><span class="hl-2">, [</span><span class="hl-3">&#39;Ship cross-platform builds&#39;</span><span class="hl-2">]);</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-7">items</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">db</span><span class="hl-2">.</span><span class="hl-1">all</span><span class="hl-2">&lt;{ </span><span class="hl-5">id</span><span class="hl-2">: </span><span class="hl-8">number</span><span class="hl-2">; </span><span class="hl-5">task</span><span class="hl-2">: </span><span class="hl-8">string</span><span class="hl-2">; </span><span class="hl-5">done</span><span class="hl-2">: </span><span class="hl-8">number</span><span class="hl-2"> }&gt;(</span><span class="hl-3">&#39;SELECT * FROM todos&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-5">items</span><span class="hl-2">);</span><br/><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">db</span><span class="hl-2">.</span><span class="hl-1">close</span><span class="hl-2">();</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-1">main</span><span class="hl-2">().</span><span class="hl-1">catch</span><span class="hl-2">((</span><span class="hl-5">error</span><span class="hl-2">) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">error</span><span class="hl-2">(</span><span class="hl-3">&#39;Database bootstrap failed&#39;</span><span class="hl-2">, </span><span class="hl-5">error</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-5">process</span><span class="hl-2">.</span><span class="hl-1">exit</span><span class="hl-2">(</span><span class="hl-9">1</span><span class="hl-2">);</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:adapter-matrix" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Adapter Matrix<a href="#md:adapter-matrix" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><table>
<thead>
<tr>
<th>Adapter</th>
<th>Package</th>
<th>Ideal for</th>
<th>Pros</th>
<th>Considerations</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>better-sqlite3</code></td>
<td><code>better-sqlite3</code></td>
<td>Node/Electron, CLI, CI</td>
<td>Native performance, transactional semantics, WAL support</td>
<td>Needs native toolchain; version must match Node ABI</td>
</tr>
<tr>
<td><code>postgres</code></td>
<td><code>pg</code></td>
<td>Hosted or on-prem PostgreSQL</td>
<td>Connection pooling, rich SQL features, cloud friendly</td>
<td>Requires <code>DATABASE_URL</code>/credentials</td>
</tr>
<tr>
<td><code>sqljs</code></td>
<td>bundled</td>
<td>Browsers, serverless edge, native fallback</td>
<td>Pure WASM, no native deps</td>
<td>Write performance limited vs native, optional persistence</td>
</tr>
<tr>
<td><code>capacitor</code></td>
<td><code>@capacitor-community/sqlite</code></td>
<td>Mobile (iOS/Android, Capacitor)</td>
<td>Native SQLite on mobile</td>
<td>Requires Capacitor runtime</td>
</tr>
<tr>
<td><code>memory</code></td>
<td>built-in</td>
<td>Unit tests, storybooks, constrained sandboxes</td>
<td>Zero dependencies, instant startup</td>
<td>Non-durable, single-process only</td>
</tr>
</tbody>
</table>
<a id="md:configuration--resolution" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration &amp; Resolution<a href="#md:configuration--resolution" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><code>resolveStorageAdapter</code> inspects:
<ul>
<li>explicit options (<code>priority</code>, <code>type</code>, adapter configs),</li>
<li>environment variables (<code>STORAGE_ADAPTER</code>, <code>DATABASE_URL</code>),</li>
<li>runtime hints (Capacitor detection, browser globals).</li>
</ul>
</li>
<li>Adapters are attempted in priority order until one opens successfully; a <code>StorageResolutionError</code> includes the full failure chain.</li>
<li>Provide <code>priority: ['memory', 'sqljs']</code> for browser bundles or tests where native modules shouldn’t load.</li>
<li>Use <code>createCloudBackupManager</code> for S3-compatible backups with gzip compression and retention limits.</li>
</ul>
<a id="md:ci-releases-and-badges" class="tsd-anchor"></a><h2 class="tsd-anchor-link">CI, Releases, and Badges<a href="#md:ci-releases-and-badges" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>GitHub Actions workflows:
<ul>
<li><code>ci.yml</code> runs lint, tests, and coverage on every branch.</li>
<li><code>release.yml</code> publishes new versions to npm, tags the commit (<code>vX.Y.Z</code>), and creates/updates the GitHub Release when <code>CHANGELOG.md</code> and <code>package.json</code> bump the version.</li>
</ul>
</li>
<li>Check badge health whenever builds fail:
<ul>
<li>CI badge should be green for <code>master</code>.</li>
<li>Codecov badge updates after coverage reports upload.</li>
<li>npm badge reflects the latest published version.</li>
</ul>
</li>
<li>Manual verification commands:<pre><code class="bash"><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-3">info</span><span class="hl-2"> </span><span class="hl-3">@framers/sql-storage-adapter</span><span class="hl-2"> </span><span class="hl-3">version</span><br/><span class="hl-1">pnpm</span><span class="hl-2"> </span><span class="hl-6">--filter</span><span class="hl-2"> </span><span class="hl-3">sql-storage-adapter</span><span class="hl-2"> </span><span class="hl-3">test</span><br/><span class="hl-1">pnpm</span><span class="hl-2"> </span><span class="hl-6">--filter</span><span class="hl-2"> </span><span class="hl-3">sql-storage-adapter</span><span class="hl-2"> </span><span class="hl-3">build</span>
</code><button type="button">Copy</button></pre>

</li>
<li>See <a href="media/RELEASING.md">RELEASING.md</a> for the automated release flow, required secrets (<code>NPM_TOKEN</code>), and manual fallback steps.</li>
</ul>
<a id="md:troubleshooting" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Troubleshooting<a href="#md:troubleshooting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong><code>better-sqlite3</code> cannot be required</strong> – install native build tools before <code>npm install</code>, ensure Node version matches prebuilt binaries, or fall back to sql.js by setting <code>STORAGE_ADAPTER=sqljs</code>.</li>
<li><strong>Adapter resolution picks the wrong backend</strong> – set <code>priority</code> or <code>STORAGE_ADAPTER</code> explicitly; register new adapters in <code>src/core/resolver.ts</code>.</li>
<li><strong>Cloud backup tests lock the database</strong> – call <code>await db.close()</code> in test teardown; use the in-memory/sql.js fallback on runners without native SQLite.</li>
<li><strong>GitHub release missing</strong> – confirm <code>release.yml</code> succeeded, <code>NPM_TOKEN</code> is configured, and the version bump is committed. Rerun the workflow if needed.</li>
<li><strong>Missing lock file in subtree mirror</strong> – keep <code>pnpm-lock.yaml</code> committed so CI caches dependencies correctly when this package is mirrored out of a monorepo.</li>
</ul>
<a id="md:contributing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contributing<a href="#md:contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Read <a href="media/CONTRIBUTING.md">CONTRIBUTING.md</a> for coding standards, lint/test commands, and pull request guidelines.</li>
<li>Architecture notes live in <a href="media/ARCHITECTURE.md">ARCHITECTURE.md</a>; API docs can be regenerated with <code>pnpm --filter sql-storage-adapter run docs</code>.</li>
</ul>
<a id="md:license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#md:license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="media/LICENSE">MIT</a></p>
<hr>
<p align="center">
  Built and maintained by <a href="https://frame.dev" target="_blank" rel="noopener">Frame.dev</a>
</p></div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:sql-storage-adapter"><span>SQL <wbr/>Storage <wbr/>Adapter</span></a><ul><li><a href="#md:features"><span>Features</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><a href="#md:quick-start"><span>Quick <wbr/>Start</span></a></li><li><a href="#md:adapter-matrix"><span>Adapter <wbr/>Matrix</span></a></li><li><a href="#md:configuration--resolution"><span>Configuration &amp; <wbr/>Resolution</span></a></li><li><a href="#md:ci-releases-and-badges"><span>CI, <wbr/>Releases, and <wbr/>Badges</span></a></li><li><a href="#md:troubleshooting"><span>Troubleshooting</span></a></li><li><a href="#md:contributing"><span>Contributing</span></a></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://frame.dev" class="tsd-nav-link">Frame.dev</a><a href="https://github.com/framersai/sql-storage-adapter" class="tsd-nav-link">GitHub</a><a href="https://www.npmjs.com/package/@framers/sql-storage-adapter" class="tsd-nav-link">NPM</a></nav><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>SQL Storage Adapter - v0.2.0</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
